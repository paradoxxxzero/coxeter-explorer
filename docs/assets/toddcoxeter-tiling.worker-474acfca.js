(function(){"use strict";const{abs:P,cos:z,sin:B,cosh:D,sinh:F,acos:G,acosh:H,tan:J,min:K,max:N,round:Q,sqrt:T,sign:U,floor:X,log:Y,exp:Z,PI:$}=Math,m=n=>String.fromCharCode(97+n),C=(n,e,s,a)=>{const t=[];for(let l=0;l<n;l++)t.push(m(l).repeat(2));for(let l=1;l<n;l++)for(let r=0;r<l;r++)t.push((m(r)+m(l)).repeat(e[l][r]));return t},V=(n,e,s,a)=>{const t=C(n,e),l=[...Array(n).keys()].map(o=>m(o)).join(""),r=a.map((o,u)=>o?"":m(P(u))).join("");return{gens:l,subgens:r,rels:t}},v=(n,e,s,a)=>{const t=C(n,e),l=[...Array(n).keys()].map(o=>m(o)).join(""),r=[];for(let o=0;o<a.length;o++)if(a[o]){let u=m(o);for(let d=0;d<n;d++)e[o][d]===2&&(a[d]||(u+=m(d)));r.push({gens:l,subgens:u,rels:t,edgeMirror:m(o)})}return r},L=(n,e)=>{if(e.left===e.right)return!1;for(;e.left!==e.right;){const s=n.normal[e.left_coset][e.rel[e.left]];if(s===void 0)break;e.left++,e.left_coset=s}for(;e.left!==e.right;){const s=n.reverse[e.right_target][e.rel[e.right]];if(s===void 0)break;e.right--,e.right_target=s}return e.left===e.right?(n.normal[e.left_coset][e.rel[e.right]]=e.right_target,n.reverse[e.right_target][e.rel[e.right]]=e.left_coset,!0):!1},M=n=>{const{gens:e,subgens:s,rels:a,cosets:t,rows:l,words:r,limit:o}=n,u=e.length,d=a.map(i=>[...i].map(c=>e.indexOf(c))),b=s.split("").map(i=>e.indexOf(i));if(t.normal.length===0){t.normal.push(new Array(u).fill()),t.reverse.push(new Array(u).fill());for(let i=0;i<b.length;i++)t.normal[0][b[i]]=0,t.reverse[0][b[i]]=0}for(l.length===0&&l.push(...d.map(i=>({rel:i,left:0,right:i.length-1,left_coset:0,right_target:0})));l.length&&t.normal.length<o;){for(;;){let f=!1;for(let h=l.length-1;h>=0;h--)L(t,l[h])&&(f=!0,l.splice(h,1));if(!f)break}const i=t.normal.length;let c=!1;for(let f=0;f<t.normal.length;f++){const h=t.normal[f];for(let g=0;g<h.length;g++){let p=h[g];if(p===void 0){p=t.normal.length,t.normal.push(new Array(u).fill()),t.reverse.push(new Array(u).fill()),t.normal[f][g]=p,t.reverse[p][g]=f,l.push(...d.map(y=>({rel:y,left:0,right:y.length-1,left_coset:i,right_target:i}))),c=!0;break}}if(c)break}}for(l.length||(n.done=!0),r.length===0&&(r[0]="");S(t.normal.length,r);)for(let i=0;i<r.length;i++){if(r[i]===void 0)continue;const c=t.normal[i];for(let f=0;f<c.length;f++){const h=c[f];r[h]===void 0&&(r[h]=r[i]+m(f))}}return{cosets:t,rows:l,words:r}},S=(n,e)=>{for(let s=0;s<n;s++)if(e[s]===void 0)return!0;return!1},E=(n,e,s)=>{let a=0;for(let t=0;t<n.length;t++)a+=n[t]*e[t]*(t===n.length-1&&s||1);return a},O=(n,e,s)=>{n=n.slice();const a=2*E(n,e,s);for(let t=0;t<n.length;t++)n[t]-=a*(s||t!==n.length-1?e[t]:0);return n};let _=null,x=null;const R=(n,e,s,a)=>{const t=()=>({cosets:{normal:[],reverse:[]},rows:[],words:[],done:!1});_={...V(n,e,s,a),...t()},x=v(n,e,s,a).map(l=>({...l,...t()}))},k=(n,e,s)=>{s&&(e=e.replace(/./g,o=>o==="a"?"ab":"bc"));const{rootVertex:a,mirrorsPlanes:t,curvature:l}=n;let r=a;for(let o=0;o<e.length;o++)r=O(r,t[e.charCodeAt(o)-97],l);return r};onmessage=({data:{order:n,curvature:e,mirrorsPlanes:s,coxeter:a,stellated:t,stellation:l,mirrors:r,rootVertex:o,dimensions:u,uuid:d}})=>{const b=r.some(c=>c==="s");n===0&&R(u,a,t?l:null,r);const i=(n+1)*(e>0?2500:250);try{let c=[],f=[];if(!_.done){let h=_.words.length;_.limit=i,M(_);for(let g=h;g<_.words.length;g++){const p=_.words[g],y=k({rootVertex:o,mirrorsPlanes:s,curvature:e},p,b);c.push({vertex:y,word:p})}}for(let h=0;h<x.length;h++){const g=x[h];if(g.done)continue;const p=g.words.length;g.limit=i,M(g);const y=o.slice(),q=k({rootVertex:y,mirrorsPlanes:s,curvature:e},g.edgeMirror,b);for(let A=p;A<g.words.length;A++){const j=g.words[A],I=k({rootVertex:y,mirrorsPlanes:s,curvature:e},j,b),W=k({rootVertex:q,mirrorsPlanes:s,curvature:e},j,b);f.push({start:I,end:W,word:j})}}postMessage({vertices:c,edges:f,uuid:d})}catch(c){postMessage({error:c.message,uuid:d})}}})();
