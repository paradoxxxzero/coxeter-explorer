import{c as xe,a as be,P as q,s as k,i as je,b as P,m as ye,e as we,d as ve,f as ae,g as V,r as h,h as U,j as Oe,k as te,l as D,n as _,o as I,p as ke,u as Ee,q as Ce,t as Se,v as B,w as Q,x as s,y as R,z as oe,C as Fe,A as Te,N,B as Ne,D as Z,E as Ae,F as Le,G as Ie,H as Pe,I as ce,J as Ve,K as He,L as ze,M as Be}from"./CoxeterDiagram-cb9bf1d6.js";const $e=(e,r)=>e.map((a,o)=>a.map((n,i)=>n<0?-xe(-n/10):n===0?-1:-be(r[o][i]*q/n))),le=e=>{const r=we(e).values;return{"+":r.filter(a=>a>0).length,"-":r.filter(a=>a<0).length,0:r.filter(a=>a===0).length}},ie=(e,r=[],a=0,o=2)=>{r[a]=r[a]||[];for(let n=0;n<e.length;n++){const i=e.filter((t,c)=>c!==n).map(t=>t.filter((c,l)=>l!==n));r[a].push(le(i)),i.length>1&&a+1<o&&ie(i,r,a+1)}return r},qe=e=>{const r=le(e);if(r["-"]===0&&r[0]===0)return{type:"finite",curvature:1};if(r["-"]===0&&r[0]>0)return{type:"affine",curvature:0};if(r["-"]>1)return{type:"hyperbolic",subtype:"superhyperbolic",level:r["-"],curvature:-1};const a=ie(e),o=a[0];if(o.every(n=>n["-"]===0&&n[0]===0))return{type:"hyperbolic",subtype:"compact",curvature:-1};if(o.every(n=>n["-"]===0))return{type:"hyperbolic",subtype:"paracompact",curvature:-1};for(let n=1;n<a.length;n++)if(a[n].every(t=>t["-"]===0))return{type:"hyperbolic",subtype:"lorentzian",curvature:-1,level:n+1};return{type:"indefinite",curvature:-1}},G=(e,r,a)=>{let o=0;for(let n=0;n<e.length;n++)o+=e[n]*r[n]*(n===e.length-1&&a||1);return o},de=(e,r)=>G(e,e,r),Ue=(e,r,a)=>{e=e.slice();const o=2*G(e,r,a);for(let n=0;n<e.length;n++)e[n]-=o*(a||n!==e.length-1?r[n]:0);return e},pe=(e,r)=>{if(e=e.slice(),r===0){for(let o=0;o<e.length;o++)e[o]/=e[e.length-1];return e}const a=(r===-1&&ve(e[e.length-1])||1)/k(ae(1e-32,P(de(e,r))));for(let o=0;o<e.length;o++)e[o]*=a;return e},De=e=>e.sort((r,a)=>{const[o,n]=r,[i,t]=a;return o===0&&n===1?1:i===0&&t===1||o<2&&i>=2?-1:i<2&&o>=2?1:o<2&&i<2?n===t?i-o:n-t:o===i?t-n:i-o}),M=(e,r,a,o,n)=>{const i=V(o);if(r>a.length-1||P(e)>1)return i;const[t,c]=a[r],l=c===o-1&&n||1,d=k(1-l*e*e),p=e;return i[t][t]=d,i[c][c]=d,i[t][c]=-l*p,i[c][t]=p,i},_e=(e,r,a,o)=>{const n=r[0].length,i=new Array(n).fill().map(()=>new Array(n).fill(0));i[e][0]=1;for(let c=1;c<n;c++){const l=(c+e)%n;for(let d=0;d<c;d++){const p=(d+e)%n;i[l][d]=(r[l][p]-G(i[l].slice(0,d),i[p].slice(0,d)))/i[p][d]}if(i[l][c]=k(P(1-de(i[l].slice(0,c)))),i[l][c]<1e-6&&c<n-1&&!o)return null}const t=(n-1+e)%n;return a===0?i[t][n-1]=.5:i[t][n-1]*=a,i},ue=(e,r,a=!1)=>{const o=e[0].length;let n=null;const i=e.every((t,c)=>t.every((l,d)=>c===d||l<=-1));if(a||i){if(n=new Array(o).fill(0).map(()=>new Array(o).fill(0)),o===2){const t=(e[0][1]+1)/2;return n[0][0]=k(t-e[0][1]),n[1][0]=-k(t-e[0][1]),n[0][1]=n[1][1]=k((r||1)*t),r===0&&(n[1][1]=.5),n}else if(o===3){const t=e[0][1],c=e[1][2],l=e[0][2],d=(t*t+c*c+l*l-2*t*c*l-1)/(t*t+c*c+l*l-2*t*c-2*t*l-2*c*l+2*t+2*c+2*l-3);return n[0][2]=n[1][2]=n[2][2]=r*k(r*d),n[2][1]=-k(1-d),n[1][1]=(c-d)/n[2][1],n[0][1]=(l-d)/n[2][1],n[1][0]=-k(1-n[1][1]**2-d),n[0][0]=k(1-n[0][1]**2-d),r===0&&(n[2][2]=.5),n}else if(o===4){const t=e[0][1],c=e[1][2],l=e[2][3],d=e[0][2],p=e[1][3],u=e[0][3],b=(t*t*l*l+c*c*u*u+d*d*p*p-t*t-c*c-l*l-d*d-p*p-u*u+2*t*p*u+2*t*c*d+2*c*l*p+2*l*d*u-2*c*d*p*u-2*t*c*l*u-2*t*l*d*p+1)/(2*(t*t*l+c*c*u+l*l*t+d*d*p+p*p*d+u*u*c-t*t-c*c-l*l-d*d-p*p-u*u-t*c*l-t*c*u-t*l*d-t*l*p-t*l*u-t*d*p-c*l*u-c*d*p-c*d*u-c*p*u-l*d*p-d*p*u+t*c*d+t*p*u+c*l*p+l*d*u+t*c+t*d+t*p+t*u+c*l+c*d+c*p+l*d+l*p+l*u+d*u+p*u-t-c-l-d-p-u+2));return n[0][3]=n[1][3]=n[2][3]=n[3][3]=r*k(r*b),n[3][2]=-k(1-b),n[2][2]=(l-b)/n[3][2],n[1][2]=(p-b)/n[3][2],n[0][2]=(u-b)/n[3][2],n[2][1]=-k(1-b-n[2][2]**2),n[1][1]=(c-b-n[1][2]*n[2][2])/n[2][1],n[0][1]=(d-b-n[0][2]*n[2][2])/n[2][1],n[1][0]=-k(1-b-n[1][1]**2-n[1][2]**2),n[0][0]=k(1-b-n[0][1]**2-n[0][2]**2),r===0&&(n[3][3]=.5),n}if(e.every((t,c)=>t.every((l,d)=>c===d||l===-1))){const t=[0];for(let c=1;c<o;c++)t[c]=(t[c-1]+1)/(3-t[c-1]);n[0][0]=1,n[1][0]=-1,n[0][1]=k(t[1]),n[1][1]=k(t[1]);for(let c=0;c<o;c++)for(let l=0;l<o;l++)c<2&&l<2||(n[c][l]=l<c-1?0:l===c-1?-(c*k(t[l]-t[l-1])):l<o-1?k(t[l]-t[l-1]):k(t[l-1]));return n}}for(let t=0;t<o&&(n=_e(t,e,r,t===o-1),!n);t++);if(!n&&!a)return ue(e,r,!0);if(n&&a){const t=he(new Array(o).fill(1),n,r);if(r!==0){const c=pe(t.slice().map((l,d)=>d===o-1?l-1:l),r);for(let l=0;l<o;l++)n[l]=Ue(n[l],c,r)}}return n},he=(e,r,a)=>{let o=e.map(c=>isNaN(c)?1:+c),n=r.slice(),i;for(let c=0;c<o.length&&(i=je(n),i.some(l=>l.some(d=>isNaN(d)||P(d)>1e8)));c++){console.warn("Non invertible matrix, retrying by shifting mirrors"),n.push(n.shift()),o.push(o.shift());if(c===o.length-1)return console.warn("Non invertible matrix, returning default value"),[0,0,1]}const t=ye(i,o);return t[t.length-1]*=a||1,pe(t,a)};class Me extends h.Component{componentDidCatch(r,a){this.props.onError(r,a)}render(){return this.props.error?null:this.props.children}}const Y=.95,J=25,S=(e,r,a,o,n,i,t)=>{D(n,_(M(e,a*2+1,o.combinations,i,t),n)),D(n,_(M(r,a*2,o.combinations,i,t),n))},We=(e,r,a,o,n,i)=>{const{code:t}=e,c=.01;if(!(e.altKey||e.ctrlKey||e.metaKey)){if(t==="ArrowLeft"||t==="KeyA")S(-c,0,0,r,a,o,n);else if(t==="ArrowRight"||t==="KeyD")S(c,0,0,r,a,o,n);else if(t==="ArrowUp"||t==="KeyW")S(0,-c,1,r,a,o,n);else if(t==="ArrowDown"||t==="KeyS")S(0,c,1,r,a,o,n);else if(t==="PageUp"||t==="KeyQ")S(-c,0,2,r,a,o,n);else if(t==="PageDown"||t==="KeyE")S(c,0,2,r,a,o,n);else if(t==="Digit1")S(0,-c,2,r,a,o,n);else if(t==="Digit3")S(0,c,2,r,a,o,n);else if(t==="KeyZ")S(-c,0,3,r,a,o,n);else if(t==="KeyC")S(c,0,3,r,a,o,n);else if(t==="ControlLeft")i("shift",(r.shift+1)%r.maxShift);else return;return!0}},Ke=(e,r,a,o)=>{const n=h.useCallback(U(p=>o({matrix:p}),100),[]),i=h.useCallback(U(p=>o({zoom:p}),100),[]),t=h.useRef(null),c=h.useRef({pause:new Set,speed:null}),l=h.useRef(e.matrix.map(p=>p.slice()));h.useEffect(()=>{l.current=e.matrix.map(p=>p.slice())},[e.matrix]);const d=h.useCallback(()=>{const p=["vertex","edge","face"];for(let u=0;u<p.length;u++)e.meshes[p[u]].uniforms.matrix.update(Oe(l.current))},[e.ambiance,e.camera,e.centered,e.coxeter,e.curvature,e.curve,e.dimensions,e.easing,e.edge,e.edgeThickness,e.error,e.face,e.fov3,e.fov4,e.fov5,e.fov6,e.fov7,e.fov8,e.fov9,e.grouper,e.msaa,e.msaaSamples,e.projection,e.ranges,e.renderError,e.segments,e.showEdges,e.showFaces,e.showVertices,e.spaceType,e.stellation,e.subsampling,e.vertexThickness,e.vertex,e.zoom]);h.useEffect(()=>{c.current.speed=new Array(r.combinations.length).fill(0)},[r.combinations]),h.useEffect(()=>{te(e.matrix)&&(c.current.speed=new Array(r.combinations.length).fill(0))},[r.combinations.length,e.matrix]),h.useEffect(()=>{const p=()=>{const{pause:u,speed:b}=c.current;let C=!1;for(let E=0;E<b.length;E++)b[E]!==0&&(C=!0,r.auto==="damp"&&(b[E]*=.96,P(b[E])<1e-4&&(b[E]=0,n(l.current))),(r.auto!=="damp"||!u.has(E))&&D(l.current,_(M(b[E],E,r.combinations,e.dimensions,e.curvature),l.current)));C&&(d(),I(e)),t.current!==null&&(t.current=requestAnimationFrame(p))};return r.auto&&(t.current=requestAnimationFrame(p)),()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null),n(l.current)}},[r.auto,r.combinations,e.dimensions,e.curvature,n,d]),h.useEffect(()=>{e.camera.position[2]=-e.zoom,e.camera.update(),e.meshes.updateUniforms(e,!0)},[e.camera,e.zoom]),h.useEffect(()=>{const p=new Map;let u=null,b=null;const C=()=>{const v=p.values(),m=v.next().value,j=v.next().value;return ke(m[0]-j[0],m[1]-j[1])},E=v=>{v.button!==0||v.target.tagName!=="CANVAS"||(r.auto&&(b=performance.now(),c.current.pause.add(r.shift*2),c.current.pause.add(r.shift*2+1),c.current.speed[r.shift*2]=0,c.current.speed[r.shift*2+1]=0),p.set(v.pointerId,[v.clientX,v.clientY]))},H=v=>{if(!p.has(v.pointerId))return;let m=p.get(v.pointerId);const j=[-(v.clientX-m[0])/window.innerHeight,-(v.clientY-m[1])/window.innerHeight];if(r.auto){const A=performance.now(),L=A-b;b=A;const F=[J*j[0]/L,J*j[1]/L];c.current.speed[r.shift*2]=F[1],c.current.speed[r.shift*2+1]=F[0]}if(p.set(v.pointerId,[v.clientX,v.clientY]),p.size===2){if(u===null){u=C();return}const A=C();e.camera.position[2]*=u/A,e.camera.update(),e.meshes.updateUniforms(e,!0),u=A,I(e),i(-e.camera.position[2]);return}let O=r.shift;!O&&v.shiftKey?O=1:!O&&v.altKey?O=2:!O&&v.ctrKey?O=3:!O&&v.metaKey&&(O=4),p.size>2&&(O+=p.size-2),S(q*j[0],q*j[1],O,{combinations:r.combinations,auto:r.auto,shift:r.shift},l.current,e.dimensions,e.curvature),d(),n(l.current)},z=v=>{p.has(v.pointerId)&&(r.auto&&(performance.now()-b>100?(c.current.speed[r.shift*2]=0,c.current.speed[r.shift*2+1]=0):r.auto==="free"&&(c.current.speed[r.shift*2]*=.5,c.current.speed[r.shift*2+1]*=.5),c.current.pause.delete(r.shift*2),c.current.pause.delete(r.shift*2+1)),u=null,p.delete(v.pointerId))};return document.addEventListener("pointerdown",E),document.addEventListener("pointermove",H),document.addEventListener("pointerup",z),()=>{document.removeEventListener("pointerdown",E),document.removeEventListener("pointermove",H),document.removeEventListener("pointerup",z)}},[r.auto,r.combinations,r.shift,e.dimensions,e.curvature,e.camera,d,n,i]),h.useEffect(()=>{const p=u=>{u.target===document.body&&We(u,r,l.current,e.dimensions,e.curvature,a)&&(d(),n(l.current))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[d,r,e.curvature,e.dimensions,a,n]),h.useEffect(()=>{const p=u=>{u.target.tagName==="CANVAS"&&(e.camera.position[2]*=u.deltaY<0?Y:1/Y,e.camera.update(),e.meshes.updateUniforms(e,!0),I(e),i(-e.camera.position[2]))};return document.addEventListener("wheel",p),()=>{document.removeEventListener("wheel",p)}},[e,i]),h.useEffect(()=>{const p=u=>{if(u.button!==0||u.target.tagName!=="CANVAS")return;const b=-e.camera.position[2],C=b<.5?5:b<2?.25:1;e.camera.position[2]=-C,e.camera.update(),e.meshes.updateUniforms(e,!0),I(e),i(C)};return document.addEventListener("dblclick",p),()=>{document.removeEventListener("dblclick",p)}},[e,i])};function Re({runtime:e,rotations:r,updateRotations:a,updateParams:o}){return Ke(e,r,a,o),null}const Ge=(e,r)=>{h.useEffect(()=>{r(a=>(Ee(a),a))},[e.fov3,e.camera,r]),h.useEffect(()=>{r(a=>(a.meshes.updateGeometries(a),a))},[e.curve,e.segments,r]),h.useEffect(()=>{r(a=>(a.meshes.changeArity(a.dimensions),a))},[e.dimensions,r]),h.useEffect(()=>{r(a=>(Ce(a),a))},[e.ambiance,e.msaa,e.msaaSamples,r]),h.useEffect(()=>{r(a=>(Se(a),a))},[e.ambiance,e.msaa,e.msaaSamples,r]),h.useEffect(()=>{r(a=>(B(a,"vertex"),B(a,"edge"),B(a,"face"),a))},[e.showVertices,e.showEdges,e.showFaces,r]),h.useEffect(()=>{r(a=>{if(!(a.currentOrder<0))return Q(a,a.currentOrder-1),a})},[e.currentOrder,e.edge,e.face,e.ranges,e.showEdges,e.showFaces,e.showVertices,e.vertex,r]),h.useEffect(()=>{r(a=>(a.meshes.recompilePrograms(a),a))},[e.ambiance,e.dimensions,e.easing,e.projection3,e.projection4,e.projection5,e.projection6,e.projection7,e.projection8,e.projection9,e.spaceType,r]),h.useEffect(()=>{r(a=>(Q(a),a))},[e.ambiance,e.curve,e.segments,e.showEdges,e.showFaces,e.showVertices,r]),h.useEffect(()=>{r(a=>(a.meshes.updateUniforms(a),a))},[e.ambiance,e.ambiance,e.curvature,e.curve,e.dimensions,e.easing,e.edgeThickness,e.fov4,e.fov5,e.fov6,e.fov7,e.fov8,e.fov9,e.matrix,e.projection3,e.projection4,e.projection5,e.projection6,e.projection7,e.projection8,e.projection9,e.segments,e.spaceType,e.vertexThickness,r]),h.useEffect(()=>{const a=new ResizeObserver(()=>{I(e)});return a.observe(e.gl.canvas,{box:"content-box"}),()=>a.disconnect()},[e.ambiance,e.camera,e.centered,e.coxeter,e.currentOrder,e.curvature,e.curve,e.dimensions,e.easing,e.edge,e.edgeThickness,e.error,e.face,e.fov3,e.fov4,e.fov5,e.fov6,e.fov7,e.fov8,e.fov9,e.grouper,e.matrix,e.msaa,e.msaaSamples,e.projection3,e.projection4,e.projection5,e.projection6,e.projection7,e.projection8,e.projection9,e.ranges,e.renderError,e.segments,e.showEdges,e.showFaces,e.showVertices,e.spaceType,e.stellation,e.subsampling,e.vertexThickness,e.vertex,e.zoom])};function Qe({runtime:e,setRuntime:r}){return Ge(e,r),null}function Ze(){return new Worker(""+new URL("knuthbendix-tiling.worker-2ea6d421.js",import.meta.url).href)}function Ye(){return new Worker(""+new URL("toddcoxeter-tiling.worker-55ce8c37.js",import.meta.url).href)}function Je(){return new Worker(""+new URL("fundamental.worker-59154751.js",import.meta.url).href)}let $=class fe{constructor(r,a){this.workerClass=a,this.name=r,this.init(),this.times={}}static uuid4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const a=Math.random()*16|0;return(r==="x"?a:a&3|8).toString(16)})}init(){this.processing=0,this.worker=new this.workerClass}kill(){this.processing>0&&(console.debug(`Killing worker ${this.name} (${this.processing})`),this.worker.terminate(),this.init())}process(r){return r.uuid=fe.uuid4(),this.processing++,this.times[r.uuid]=performance.now(),this.worker.postMessage(r),new Promise((a,o)=>{const n=t=>{if(t.data.uuid!==r.uuid)return;const c=performance.now()-this.times[r.uuid];if(delete this.times[r.uuid],console.debug(`Worker ${this.name} took ${c}ms`),this.processing--,this.worker.removeEventListener("message",n),this.worker.removeEventListener("error",i),t.data.error){o(t.data.error);return}a(t.data)},i=t=>{this.worker.removeEventListener("message",n),this.worker.removeEventListener("error",i),!(this.processing<=0)&&(delete this.times[r.uuid],this.processing--,this.processing=ae(0,this.processing),console.error(`Can't call web worker ${this.name}`,t))};this.worker.addEventListener("message",n),this.worker.addEventListener("error",i)})}};const Xe=()=>Object.values(me).filter(e=>e.processing>0).forEach(e=>e.kill()),me={knuthbendix:new $("knuthbendix",Ze),toddcoxeter:new $("toddcoxeter",Ye),fundamental:new $("toddcoxeter",Je)},X=async(e,r,a)=>{const o=me[e.grouper.replace(/^auto-/,"")];if(e.currentOrder===0&&(Xe(),r.current=!1),r.current===e.currentOrder){console.log("already processing at ",e.currentOrder);return}try{r.current=e.currentOrder;const{vertices:n,edges:i,faces:t,order:c}=await o.process({order:e.currentOrder,coxeter:e.coxeter,curvature:e.curvature,stellation:e.stellation,mirrors:e.mirrors,mirrorsPlanes:e.mirrorsPlanes,rootVertex:e.rootVertex,dimensions:e.dimensions});r.current=!1,a(l=>l.currentOrder!==c?(console.warn("Mismatched order, ignoring",l.currentOrder,c),{...l,currentOrder:0,vertex:[],edge:[],face:[],ranges:[],renderError:null,processing:!0,error:"Mismatch Order"}):{...l,ranges:[...l.ranges,{vertex:[l.vertex.length,l.vertex.length+n.length],edge:[l.edge.length,l.edge.length+i.length],face:[l.face.length,l.face.length+t.length]}],vertex:l.vertex.concat(n),edge:l.edge.concat(i),face:l.face.concat(t),currentOrder:c+1,processing:!1,error:null})}catch(n){r.current=!1,console.error(n);const i={...e,currentOrder:e.order,error:n.message,processing:!1};a(i)}},er=(e,r)=>{const a=h.useRef(!1);h.useEffect(()=>{r(o=>o.order<o.currentOrder?{...o,currentOrder:o.order}:o)},[e.order,e.currentOrder,r]),h.useEffect(()=>{r(o=>{const n=$e(o.coxeter,o.stellation),i=qe(n);if(!i)return{...o,spaceType:i};const t=i.curvature,c=o.grouper===""||o.grouper.startsWith("auto-")?"auto-toddcoxeter":o.grouper,l=ue(n,t,o.centered===null?c.replace(/^auto-/,"")==="toddcoxeter"&&t<=0||n.some(u=>u.some(b=>b===-1)):o.centered),d=he(o.mirrors,l,t),p={...o,currentOrder:0,grouper:c,vertex:[],edge:[],face:[],ranges:[],spaceType:i,curvature:t,mirrorsPlanes:l,rootVertex:d,renderError:null,processing:!0,error:null};return X(p,a,r),p})},[e.dimensions,e.coxeter,e.mirrors,e.stellation,e.centered,e.grouper,r]),h.useEffect(()=>{r(o=>({...o,matrix:V(o.dimensions)}))},[e.curvature,r]),h.useEffect(()=>{r(o=>{var n;return o.order<=o.currentOrder?o:(n=o.ranges)!=null&&n[o.order]?{...o,currentOrder:o.order,askedOrder:null}:(X(o,a,r),{...o,error:null,processing:!0})})},[r,e.order,e.currentOrder])};function rr({runtime:e,setRuntime:r}){return er(e,r),null}function nr({runtime:e,setRuntime:r,rotations:a,updateRotations:o,updateParams:n}){window.rt=e;const i=h.useCallback(t=>{r(c=>({...c,renderError:t.message}))},[r]);return h.useEffect(()=>()=>{e.curvature!==null&&n({matrix:V(e.dimensions)})},[e.curvature]),s.jsx(s.Fragment,{children:s.jsxs(Me,{error:e.renderError,onError:i,children:[s.jsx(rr,{runtime:e,setRuntime:r}),s.jsx(Qe,{runtime:e,setRuntime:r}),e.curvature!==null?s.jsx(Re,{runtime:e,rotations:a,updateRotations:o,updateParams:n}):null]})})}const sr="modulepreload",ar=function(e,r){return new URL(e,r).href},ee={},tr=function(r,a,o){if(!a||a.length===0)return r();const n=document.getElementsByTagName("link");return Promise.all(a.map(i=>{if(i=ar(i,o),i in ee)return;ee[i]=!0;const t=i.endsWith(".css"),c=t?'[rel="stylesheet"]':"";if(!!o)for(let p=n.length-1;p>=0;p--){const u=n[p];if(u.href===i&&(!t||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${c}`))return;const d=document.createElement("link");if(d.rel=t?"stylesheet":sr,t||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),t)return new Promise((p,u)=>{d.addEventListener("load",p),d.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>r()).catch(i=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=i,window.dispatchEvent(t),!t.defaultPrevented)throw i})};function re({allowNull:e,name:r,value:a,onChange:o,...n}){const i=h.useCallback(c=>{let{name:l,checked:d}=c.target,p;e?p=a===!1?!0:a?null:!1:p=d,o(l,p)},[e,o,a]),t=h.useRef(null);return h.useLayoutEffect(()=>{e&&t.current&&(a===null?t.current.indeterminate=!0:t.current.indeterminate=!1)},[a,e]),s.jsx("input",{type:"checkbox",ref:t,name:r,checked:a||!1,onChange:i})}function y({type:e,subtype:r,level:a,dimensions:o}){return s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"space",children:e===null||e==="indefinite"?"𝕏":e==="affine"?"𝔼":e==="finite"?"𝕊":"ℍ"}),o?s.jsx("sup",{children:o-1}):null,e==="hyperbolic"?s.jsxs("sub",{children:[{compact:" ",paracompact:"*",lorentzian:"L",superhyperbolic:"**"}[r],a]}):null]})}const or=(...e)=>{if(Array.isArray(e[0]))return{coxeter:e,dimensions:e.length,extended:!0};const r=e.length+1;return{coxeter:new Array(r).fill().map((o,n)=>new Array(r).fill().map((i,t)=>n===t?1:n===t+1||t===n+1?e[oe(n,t)]:2)),dimensions:r}},cr=(...e)=>{const r=e.length+1;return{stellation:new Array(r).fill().map((o,n)=>new Array(r).fill().map((i,t)=>n===t?1:n===t+1||t===n+1?e[oe(n,t)]:1))}},f=(e,r,a,o)=>{const n=or(...e),{dimensions:i}=n,t={...R,...n,showVertices:i<=3,showFaces:i<=4,curve:i>3,grouper:"toddcoxeter",ambiance:"colorful",matrix:V(i),zoom:i<=3?2:i>4?3:5,...o||{}};return r?t.mirrors=r:t.mirrors=new Array(i).fill().map((c,l)=>l===0?1:0),a?t.stellation=cr(...a).stellation:t.stellation=new Array(i).fill().map((c,l)=>new Array(i).fill(1)),t},w=e=>({...e,subforms:Object.entries(lr(e.params.dimensions)).map(([r,a])=>({name:`${r} ${e.name}`,params:{...e.params,mirrors:a}}))}),g=(e,r,a,o)=>({...f(e,r,a),ambiance:"plain",showVertices:!1,curve:!0,zoom:1,...o}),T=(e,r,a,o)=>({...f(e,r,a),ambiance:"neon",showFaces:!1,showVertices:!1,grouper:"",edgeThickness:10,zoom:2,...o}),x=(e,r,a,o)=>({...f(e,r,a),ambiance:"neon",showFaces:!1,showVertices:!1,curve:!0,grouper:"",edgeThickness:10,zoom:1.5,...o}),lr=e=>{if(e===4)return{Rectified:[0,1,0,0],Truncated:[1,1,0,0],Cantellated:[1,0,1,0],Cantitruncated:[1,1,1,0],Runcitruncated:[1,1,0,1],Runcinated:[1,0,0,1],Bitruncated:[0,1,1,0],Omnitruncated:[1,1,1,1]};if(e===5)return{Rectified:[0,1,0,0,0],Birectified:[0,0,1,0,0],Truncated:[1,1,0,0,0],Cantellated:[1,0,1,0,0],Runcinated:[1,0,0,1,0],Stericated:[1,0,0,0,1],Omnitruncated:[1,1,1,1,1]};if(e===6)return{Rectified:[0,1,0,0,0,0],Birectified:[0,0,1,0,0,0],Truncated:[1,1,0,0,0,0],Bitruncated:[0,1,1,0,0,0],Tritruncated:[0,0,1,1,0,0],Cantellated:[1,0,1,0,0,0],Bicantellated:[0,1,0,1,0,0],Runcinated:[1,0,0,1,0,0],Biruncinated:[0,1,0,0,1,0],Stericated:[1,0,0,0,1,0],Pentellated:[1,0,0,0,0,1],Omnitruncated:[1,1,1,1,1,1]};if(e===7)return{Rectified:[0,1,0,0,0,0,0],Birectified:[0,0,1,0,0,0,0],Truncated:[1,1,0,0,0,0,0],Bitruncated:[0,1,1,0,0,0,0],Tritruncated:[0,0,1,1,0,0,0],Cantellated:[1,0,1,0,0,0,0],Bicantellated:[0,1,0,1,0,0,0],Runcinated:[1,0,0,1,0,0,0],Biruncinated:[0,1,0,0,1,0,0],Stericated:[1,0,0,0,1,0,0],Pentellated:[1,0,0,0,0,1,0],Hexicated:[1,0,0,0,0,0,1],Omnitruncated:[1,1,1,1,1,1,1]};if(e===8)return{Rectified:[0,1,0,0,0,0,0,0],Birectified:[0,0,1,0,0,0,0,0],Truncated:[1,1,0,0,0,0,0,0],Bitruncated:[0,1,1,0,0,0,0,0],Tritruncated:[0,0,1,1,0,0,0,0],Quadritruncated:[0,0,0,1,1,0,0,0],Cantellated:[1,0,1,0,0,0,0,0],Bicantellated:[0,1,0,1,0,0,0,0],Tricantellated:[0,0,1,0,1,0,0,0],Runcinated:[1,0,0,1,0,0,0,0],Biruncinated:[0,1,0,0,1,0,0,0],Triruncinated:[0,0,1,0,0,1,0,0],Stericated:[1,0,0,0,1,0,0,0],Pentellated:[1,0,0,0,0,1,0,0],Hexicated:[1,0,0,0,0,0,1,0],Heptellated:[1,0,0,0,0,0,0,1],Omnitruncated:[1,1,1,1,1,1,1,1]};if(e===9)return{Rectified:[0,1,0,0,0,0,0,0,0],Birectified:[0,0,1,0,0,0,0,0,0],Truncated:[1,1,0,0,0,0,0,0,0],Bitruncated:[0,1,1,0,0,0,0,0,0],Tritruncated:[0,0,1,1,0,0,0,0,0],Quadritruncated:[0,0,0,1,1,0,0,0,0],Cantellated:[1,0,1,0,0,0,0,0,0],Bicantellated:[0,1,0,1,0,0,0,0,0],Tricantellated:[0,0,1,0,1,0,0,0,0],Runcinated:[1,0,0,1,0,0,0,0,0],Biruncinated:[0,1,0,0,1,0,0,0,0],Triruncinated:[0,0,1,0,0,1,0,0,0],Stericated:[1,0,0,0,1,0,0,0,0],Pentellated:[1,0,0,0,0,1,0,0,0],Hexicated:[1,0,0,0,0,0,1,0,0],Heptellated:[1,0,0,0,0,0,0,1,0],Octellated:[1,0,0,0,0,0,0,0,1],Omnitruncated:[1,1,1,1,1,1,1,1,1]}},ir=[{type:"title",content:s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{color:"orange"},children:"★"})," Highlights"]})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:4})," Tesseract"]}),params:f([4,3,3],[1,0,0,0],null,{showVertices:!0,vertexThickness:150,showFaces:!0,curve:!0,ambiance:"neon",centered:!1,zoom:4.2})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",dimensions:3})," 7-3-2 tiling"]}),params:g([7,3],[1,0,0],null,{showVertices:!1,showFaces:!0,curve:!0,ambiance:"neon"})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"paracompact",dimensions:3})," Ideal triangles"]}),params:g([[1,0,0],[0,1,0],[0,0,1]],[1,1,1],null,{grouper:"fundamental",showVertices:!1,showFaces:!0,curve:!0,segments:64,easing:"quartic",ambiance:"neon"})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"paracompact",dimensions:4})," Ideal tetrahedron"]}),params:g([3,3,6],[1,0,0,""],null,{showVertices:!1,showFaces:!0,curve:!0,order:1,centered:!1,segments:64,easing:"quartic",ambiance:"pure"})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"paracompact",dimensions:4})," ","Horoball"]}),params:g([6,3,4],[1,0,0,""],null,{showVertices:!1,showFaces:!0,curve:!0,order:20,centered:!1,ambiance:"colorful"})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",dimensions:4})," 5-3-4 honeycomb"]}),params:x([5,3,4],[1,0,0,0],null,{zoom:1.5})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"lorentzian",level:2,dimensions:4})," ","7-3-3 paracompact honeycomb"]}),params:x([7,3,3],[1,0,0,0],null,{zoom:1.5,showFaces:!0,showVertices:!0,segments:16})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"paracompact",dimensions:4})," Ideal Pentahedron"]}),params:g([5,3,6],[1,0,0,""],null,{showVertices:!1,showFaces:!0,curve:!0,order:1,centered:!1,segments:32,easing:"quartic",ambiance:"pure",zoom:1.5})},{name:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:4})," Flat Torus"]}),params:f([32,2,32],[1,0,0,1],null,{showVertices:!1,showFaces:!1,curve:!0,ambiance:"neon",zoom:3,edgeThickness:5})},{type:"title",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite"})," Spherical space"]})},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:3})," Polyedra"]})},{name:"Tetrahedron",params:f([3,3]),subforms:[{name:"Truncated Tetrahedron",params:f([3,3],[1,1,0])}]},{name:"Cube",params:f([4,3]),subforms:[{name:"Cuboctahedron",params:f([4,3],[0,1,0])},{name:"Truncated Cube",params:f([4,3],[1,1,0])},{name:"Rhombicuboctahedron",params:f([4,3],[1,0,1])},{name:"Truncated Octahedron",params:f([3,4],[1,1,0])},{name:"Truncated Cuboctahedron",params:f([4,3],[1,1,1])},{name:"Octahedron",params:f([3,4])}]},{name:"Dodecahedron",params:f([5,3]),subforms:[{name:"Icosidodecahedron",params:f([5,3],[0,1,0])},{name:"Truncate Dodecahedron",params:f([5,3],[1,1,0])},{name:"Rhombicosidodecahedron",params:f([5,3],[1,0,1])},{name:"Truncate Icosahedron",params:f([3,5],[1,1,0])},{name:"Truncated Icosidodecahedron",params:f([5,3],[1,1,1])},{name:"Icosahedron",params:f([3,5])}]},{name:"Snub Cube",params:f([4,3],["s","s","s"])},{name:"Snub Dodecahedron",params:f([5,3],["s","s","s"])},{name:"Great Dodecahedron",params:f([5,5],[1,0,0],[1,2])},{name:"Great Icosahedron",params:f([3,5],[1,0,0],[1,2])},{name:"Small Stellated Dodecahedron",params:f([5,5],[1,0,0],[2,1])},{name:"Great Stellated Dodecahedron",params:f([5,3],[1,0,0],[2,1])},{name:"Stellated Octahedron",params:f([2,2],["ß","ß","ß"])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:4})," Polychora"]})},w({name:"5-cell",params:f([3,3,3])}),w({name:"8-cell",params:f([4,3,3])}),w({name:"16-cell",params:f([3,3,4])}),w({name:"24-cell",params:f([3,4,3])}),w({name:"120-cell",params:f([5,3,3])}),w({name:"600-cell",params:f([3,3,5])}),{name:"Snub 24-cell",params:f([3,4,3],["s","s",0,0])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:5})," Polytera"]})},w({name:"5-simplex",params:f([3,3,3,3])}),w({name:"5-cube",params:f([4,3,3,3])}),w({name:"5-orthoplex",params:f([3,3,3,4])}),w({name:"5-demicube",params:f([[1,2,3,2,2],[2,1,3,2,2],[3,3,1,3,2],[2,2,3,1,3],[2,2,2,3,1]])}),{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:6})," Polypeta"]})},w({name:"6-simplex",params:f([3,3,3,3,3])}),w({name:"6-cube",params:f([4,3,3,3,3])}),w({name:"6-orthoplex",params:f([3,3,3,3,4])}),w({name:"6-demicube",params:f([[1,2,3,2,2,2],[2,1,3,2,2,2],[3,3,1,3,2,2],[2,2,3,1,3,2],[2,2,2,3,1,3],[2,2,2,2,3,1]])}),{name:s.jsxs(s.Fragment,{children:["2",s.jsx("sub",{children:"21"})]}),params:f([[1,3,2,2,2,2],[3,1,3,2,2,2],[2,3,1,3,3,2],[2,2,3,1,2,2],[2,2,3,2,1,3],[2,2,2,2,3,1]],[1,0,0,0,0,0])},{name:s.jsxs(s.Fragment,{children:["1",s.jsx("sub",{children:"22"})]}),params:f([[1,3,2,2,2,2],[3,1,3,2,2,2],[2,3,1,3,3,2],[2,2,3,1,2,2],[2,2,3,2,1,3],[2,2,2,2,3,1]],[0,0,0,1,0,0])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:7})," Polyexa"]})},w({name:"7-simplex",params:f([3,3,3,3,3,3])}),w({name:"7-cube",params:f([4,3,3,3,3,3])}),w({name:"7-orthoplex",params:f([3,3,3,3,3,4])}),w({name:"7-demicube",params:f([[1,2,3,2,2,2,2],[2,1,3,2,2,2,2],[3,3,1,3,2,2,2],[2,2,3,1,3,2,2],[2,2,2,3,1,3,2],[2,2,2,2,3,1,3],[2,2,2,2,2,3,1]])}),{name:s.jsxs(s.Fragment,{children:["3",s.jsx("sub",{children:"21"})]}),params:f([[1,3,2,2,2,2,2],[3,1,3,2,2,2,2],[2,3,1,3,2,2,2],[2,2,3,1,3,3,2],[2,2,2,3,1,2,2],[2,2,2,3,2,1,3],[2,2,2,2,2,3,1]],[1,0,0,0,0,0,0])},{name:s.jsxs(s.Fragment,{children:["2",s.jsx("sub",{children:"31"})]}),params:f([[1,3,2,2,2,2,2],[3,1,3,2,2,2,2],[2,3,1,3,2,2,2],[2,2,3,1,3,3,2],[2,2,2,3,1,2,2],[2,2,2,3,2,1,3],[2,2,2,2,2,3,1]],[0,0,0,0,0,0,1])},{name:s.jsxs(s.Fragment,{children:["1",s.jsx("sub",{children:"32"})]}),params:f([[1,3,2,2,2,2,2],[3,1,3,2,2,2,2],[2,3,1,3,2,2,2],[2,2,3,1,3,3,2],[2,2,2,3,1,2,2],[2,2,2,3,2,1,3],[2,2,2,2,2,3,1]],[0,0,0,0,1,0,0])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:8})," Polyzetta"]})},w({name:"8-simplex",params:f([3,3,3,3,3,3,3])}),w({name:"8-cube",params:f([4,3,3,3,3,3,3])}),w({name:"8-orthoplex",params:f([3,3,3,3,3,3,4])}),w({name:"8-demicube",params:f([[1,2,3,2,2,2,2,2],[2,1,3,2,2,2,2,2],[3,3,1,3,2,2,2,2],[2,2,3,1,3,2,2,2],[2,2,2,3,1,3,2,2],[2,2,2,2,3,1,3,2],[2,2,2,2,2,3,1,3],[2,2,2,2,2,2,3,1]])}),{name:s.jsxs(s.Fragment,{children:["1",s.jsx("sub",{children:"42"})]}),params:f([[1,3,2,2,2,2,2,2],[3,1,3,2,2,2,2,2],[2,3,1,3,3,2,2,2],[2,2,3,1,2,2,2,2],[2,2,3,2,1,3,2,2],[2,2,2,2,3,1,3,2],[2,2,2,2,2,3,1,3],[2,2,2,2,2,2,3,1]],[0,0,1,0,0,0,0,0])},{name:s.jsxs(s.Fragment,{children:["2",s.jsx("sub",{children:"41"})]}),params:f([[1,3,2,2,2,2,2,2],[3,1,3,2,2,2,2,2],[2,3,1,3,3,2,2,2],[2,2,3,1,2,2,2,2],[2,2,3,2,1,3,2,2],[2,2,2,2,3,1,3,2],[2,2,2,2,2,3,1,3],[2,2,2,2,2,2,3,1]],[1,0,0,0,0,0,0,0])},{name:s.jsxs(s.Fragment,{children:["4",s.jsx("sub",{children:"21"})]}),params:f([[1,3,2,2,2,2,2,2],[3,1,3,2,2,2,2,2],[2,3,1,3,3,2,2,2],[2,2,3,1,2,2,2,2],[2,2,3,2,1,3,2,2],[2,2,2,2,3,1,3,2],[2,2,2,2,2,3,1,3],[2,2,2,2,2,2,3,1]],[0,0,0,0,0,0,0,1])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"finite",dimensions:9}),"Polyyotta"]})},w({name:"9-simplex",params:f([3,3,3,3,3,3,3,3])}),w({name:"9-cube",params:f([4,3,3,3,3,3,3,3])}),w({name:"9-orthoplex",params:f([3,3,3,3,3,3,3,4])}),w({name:"9-demicube",params:f([[1,2,3,2,2,2,2,2,2],[2,1,3,2,2,2,2,2,2],[3,3,1,3,2,2,2,2,2],[2,2,3,1,3,2,2,2,2],[2,2,2,3,1,3,2,2,2],[2,2,2,2,3,1,3,2,2],[2,2,2,2,2,3,1,3,2],[2,2,2,2,2,2,3,1,3],[2,2,2,2,2,2,2,3,1]])}),{type:"title",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"affine"})," Euclidean space"]})},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"affine",dimensions:3})," Tilings"]})},{name:"Triangle",params:f([[1,3,3],[3,1,3],[3,3,1]],[1,0,0])},{name:"Square",params:f([4,4],[1,0,0])},{name:"Hexagonal",params:f([6,3],[1,0,0])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"affine",dimensions:4})," Honeycombs"]})},{name:"Cubic",params:T([4,3,4],[1,0,0,0])},{name:"Octet",params:T([[1,3,2,2],[3,1,3,4],[2,3,1,2],[2,4,2,1]],[1,0,0,0])},{name:"Quarter cubic",params:T([[1,3,2,3],[3,1,3,2],[2,3,1,3],[3,2,3,1]],[1,0,0,1])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"affine",dimensions:5})," 4-Honeycombs"]})},{name:"Tesseractic",params:T([4,3,3,4],[1,0,0,0,0])},{name:"16-cellic",params:T([3,3,4,3],[1,0,0,0,0],null,{grouper:"toddcoxeter"})},{name:"24-cellic",params:T([3,4,3,3],[1,0,0,0,0],null,{grouper:"toddcoxeter"})},{name:"4-simpletic",params:T([[1,3,2,2,3],[3,1,3,2,2],[2,3,1,3,2],[2,2,3,1,3],[3,2,2,3,1]],[1,0,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Quarter tesseractic",params:T([[1,2,3,2,2],[2,1,3,2,2],[3,3,1,3,3],[2,2,3,1,2],[2,2,3,2,1]],[1,0,0,1,0],null,{grouper:"toddcoxeter"})},{type:"title",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic"})," Hyperbolic space"]})},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",dimensions:3})," Tilings"]})},{name:"Order-7 triangular",params:g([3,7],[1,0,0])},{name:"Order-8 triangular",params:g([3,8],[1,0,0])},{name:"Infinite Order triangular",params:g([3,0],[1,0,0])},{name:"Order-5 square",params:g([4,5],[1,0,0])},{name:"Order-6 square",params:g([4,6],[1,0,0])},{name:"Order-7 square",params:g([4,7],[1,0,0])},{name:"Order-8 square",params:g([4,8],[1,0,0])},{name:"Infinite Order square",params:g([4,0],[1,0,0])},{name:"Order-4 pentagonal",params:g([5,4],[1,0,0])},{name:"Order-5 pentagonal",params:g([5,5],[1,0,0])},{name:"Order-6 pentagonal",params:g([5,6],[1,0,0])},{name:"Order-7 pentagonal",params:g([5,7],[1,0,0])},{name:"Order-8 pentagonal",params:g([5,8],[1,0,0])},{name:"Infinite Order pentagonal",params:g([5,0],[1,0,0])},{name:"Order-4 hexagonal",params:g([6,4],[1,0,0])},{name:"Order-5 hexagonal",params:g([6,5],[1,0,0])},{name:"Order-6 hexagonal",params:g([6,6],[1,0,0])},{name:"Order-7 hexagonal",params:g([6,7],[1,0,0])},{name:"Order-8 hexagonal",params:g([6,8],[1,0,0])},{name:"Infinite Order hexagonal",params:g([6,0],[1,0,0])},{name:"Order-3 heptagonal",params:g([7,3],[1,0,0])},{name:"Order-4 heptagonal",params:g([7,4],[1,0,0])},{name:"Order-5 heptagonal",params:g([7,5],[1,0,0])},{name:"Order-6 heptagonal",params:g([7,6],[1,0,0])},{name:"Order-7 heptagonal",params:g([7,7],[1,0,0])},{name:"Order-8 heptagonal",params:g([7,8],[1,0,0])},{name:"Infinite Order heptagonal",params:g([7,0],[1,0,0])},{name:"Order-3 octagonal",params:g([8,3],[1,0,0])},{name:"Order-4 octagonal",params:g([8,4],[1,0,0])},{name:"Order-5 octagonal",params:g([8,5],[1,0,0])},{name:"Order-6 octagonal",params:g([8,6],[1,0,0])},{name:"Order-7 octagonal",params:g([8,7],[1,0,0])},{name:"Order-8 octagonal",params:g([8,8],[1,0,0])},{name:"Infinite Order octagonal",params:g([8,0],[1,0,0])},{name:"Order-3 apeirogonal",params:g([0,3],[1,0,0])},{name:"Order-4 apeirogonal",params:g([0,4],[1,0,0])},{name:"Order-5 apeirogonal",params:g([0,5],[1,0,0])},{name:"Order-6 apeirogonal",params:g([0,6],[1,0,0])},{name:"Order-7 apeirogonal",params:g([0,7],[1,0,0])},{name:"Order-8 apeirogonal",params:g([0,8],[1,0,0])},{name:"Infinite Order apeirogonal",params:g([0,0],[1,0,0])},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"compact",dimensions:4})," Honeycombs compacts"]})},{name:"Icosahedral",params:x([3,5,3],[1,0,0,0])},{name:"Order-4 dodecahedral",params:x([5,3,4],[1,0,0,0])},{name:"Order-5 dodecahedral",params:x([5,3,5],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Order-5 cubic",params:x([[1,2,3,2],[2,1,3,2],[3,3,1,5],[2,2,5,1]],[1,0,0,0])},{name:"Tetrahedral cubic",params:x([[1,4,2,3],[4,1,3,2],[2,3,1,3],[3,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Tetrahedral dodecahedral",params:x([[1,3,2,5],[3,1,3,2],[2,3,1,3],[5,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Cubic octahedral",params:x([[1,3,2,4],[3,1,4,2],[2,4,1,3],[4,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Octahedral Dodcahedral",params:x([[1,3,2,5],[3,1,4,2],[2,4,1,3],[5,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Octahedral Icosahedral",params:x([[1,3,2,5],[3,1,5,2],[2,5,1,3],[5,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"paracompact",dimensions:4})," ","Honeycombs paracompacts"]})},{name:"Triangular",params:x([3,6,3],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Hexagonal",params:x([6,3,3],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Order-6 tetrahedral",params:x([3,3,6],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Order-6 cubic",params:x([[1,2,3,2],[2,1,3,2],[3,3,1,6],[2,2,6,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Order-5 hexagonal",params:x([6,3,5],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Order-5 hexagonal",params:x([[1,2,3,2],[2,1,3,2],[3,3,1,5],[2,2,5,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Order-6 hexagonal",params:x([6,3,6],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Square",params:x([4,4,3],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated square",params:x([[1,2,4,2],[2,1,4,2],[4,4,1,3],[2,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Order-4 square",params:x([4,4,4],[0,1,0,0],null,{grouper:"toddcoxeter"})},{name:"Tetrahedral square",params:x([[1,4,2,4],[4,1,3,2],[2,3,1,3],[4,2,3,1]],[0,1,0,0],null,{grouper:"toddcoxeter"})},{name:"Cubic square",params:x([[1,4,2,4],[4,1,3,2],[2,3,1,4],[4,2,4,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Quarter order square",params:x([[1,4,2,4],[4,1,4,2],[2,4,1,4],[4,2,4,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Tetrahedral Hexagonal",params:x([[1,3,2,6],[3,1,3,2],[2,3,1,3],[6,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Octahedral Hexagonal",params:x([[1,3,2,6],[3,1,4,2],[2,4,1,3],[6,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Icosahedral Hexagonal",params:x([[1,3,2,6],[3,1,5,2],[2,5,1,3],[6,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Hexagonal Triangular",params:x([[1,3,2,6],[3,1,6,2],[2,6,1,3],[6,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Hexagonal",params:x([[1,3,3,2],[3,1,3,2],[3,3,1,3],[2,2,3,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Order-4 Hexagonal",params:x([[1,3,3,2],[3,1,3,2],[3,3,1,4],[2,2,4,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Alternated Order-5 Hexagonal",params:x([[1,3,3,2],[3,1,3,2],[3,3,1,5],[2,2,5,1]],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"Runcic Order-6 Hexagonal",params:x([[1,3,3,2],[3,1,3,2],[3,3,1,6],[2,2,6,1]],[1,0,0,1],null,{grouper:"toddcoxeter"})},{name:"Quarter Order-4 hexagonal",params:x([[1,3,3,2],[3,1,3,3],[3,3,1,3],[2,3,3,1]],[1,1,0,0],null,{grouper:"toddcoxeter"})},{name:"Hexagonal",params:x([[1,3,3,3],[3,1,3,3],[3,3,1,3],[3,3,3,1]],[1,1,1,1],null,{grouper:"toddcoxeter"})},{type:"group",content:s.jsxs(s.Fragment,{children:[s.jsx(y,{type:"hyperbolic",subtype:"lorentzian",level:2,dimensions:4})," ","Honeycombs lorentzians"]})},{name:"3-3-7",params:x([3,3,7],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"3-4-7",params:x([3,3,7],[1,0,0,0],null,{grouper:"toddcoxeter"})},{name:"3-5-7",params:x([3,5,7],[1,0,0,0],null,{grouper:"toddcoxeter"})}],W=e=>{if(["string","number"].includes(typeof e))return e;if(e instanceof Array)return e.map(W).join("");if(typeof e=="object"&&e)return W(e.props.children)},ne=(e,r)=>typeof e=="string"?W(e).toLowerCase().includes(r.toLowerCase()):!1,dr=h.memo(function e({name:r,params:a,search:o,subforms:n=[],sub:i=!1,onPreset:t}){const[c,l]=h.useState(!0),[d,p]=h.useState(!1);return h.useEffect(()=>{if(!o){l(!0),p(!1);return}if(ne(r,o)){l(!0);return}if(n.length&&n.some(({name:u})=>ne(u,o))){l(!0),p(!0);return}l(!1),p(!1)},[r,o,n]),c?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`preset${i?" sub":""}`,onClick:()=>t(a),children:[s.jsxs("div",{className:`preset-header preset-name-${n.length?"button":"only"}`,children:[n.length?s.jsx("button",{className:`preset-toggle ${d?"open":"closed"}`,onClick:u=>{u.stopPropagation(),p(!d)},children:d?"-":"+"}):null,s.jsx("span",{className:"preset-name",children:r})]}),s.jsx(Fe,{coxeter:a.coxeter,mirrors:a.mirrors,stellation:a.stellation})]}),d&&n.map((u,b)=>s.jsx(e,{...u,sub:!0,search:o,onPreset:t},b))]}):null}),pr=s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M7.95 19L3 12l4.95-7H21v14H7.95Zm3.45-3l2.6-2.6l2.6 2.6l1.4-1.4l-2.6-2.6L18 9.4L16.6 8L14 10.6L11.4 8L10 9.4l2.6 2.6l-2.6 2.6l1.4 1.4Z"})}),ur=s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M6 17c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1H6m9-9a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3a3 3 0 0 1 3 3M3 5v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2Z"})}),hr=s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m-1 1.5L18.5 9H13m-4.07 3.22H16v7.07l-2.12-2.12L11.05 20l-2.83-2.83l2.83-2.82"})}),fr=s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6L6.4 19Z"})});function mr({open:e,onPreset:r,onExportImage:a,closePresets:o}){const[n,i]=h.useState(""),[t,c]=h.useState(""),l=h.useCallback(d=>{c(d.target.value),U(i(d.target.value),50)},[]);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`presets-overlay ${e?"shown":"hidden"}`,onClick:o}),s.jsx("div",{className:`presets ${e?"shown":"hidden"}`,children:s.jsxs("div",{className:"presets-modal",children:[s.jsxs("div",{className:"presets-header",children:[s.jsxs("div",{className:"presets-search",children:[s.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:l}),s.jsx("button",{className:"presets-clear",onClick:()=>{i(""),c("")},children:pr})]}),s.jsxs("div",{className:"presets-actions",children:[s.jsx("a",{className:"presets-action",href:"https://florian.mounier.dev/",children:ur}),s.jsx("button",{className:"presets-action",onClick:a,children:hr}),s.jsx("button",{className:"presets-action",onClick:o,children:fr})]})]}),s.jsx("div",{className:"presets-list",children:ir.map(({type:d,content:p,name:u,params:b,subforms:C},E)=>s.jsx(h.Fragment,{children:d==="title"?s.jsx("h2",{children:p}):d==="group"?s.jsx("h4",{children:p}):s.jsx(dr,{name:u,params:b,search:n,subforms:C,onPreset:r})},E))})]})})]})}function gr({runtime:e,params:r,rotations:a,updateParams:o,updateRotations:n}){const[i,t]=h.useState("simple"),[c,l]=h.useState(!1),d=h.useCallback(()=>{l(!1)},[]),p=h.useCallback(m=>{let{name:j,value:O}=m.target;o({[j]:O})},[o]),u=h.useCallback((m,j)=>{o({[m]:j})},[o]),b=h.useCallback(()=>t(m=>({simple:"advanced",advanced:"full",full:"empty",empty:"simple"})[m]),[]),C=h.useCallback(m=>{o(m),d()},[o,d]),E=h.useCallback(()=>{o({matrix:V(e.dimensions)})},[o,e.dimensions]),H=h.useCallback(m=>{n("shift",(a.shift+1)%a.maxShift)},[a.maxShift,a.shift,n]),z=h.useCallback(m=>{n("auto",a.auto==="free"?"damp":"free")},[a.auto,n]),v=h.useCallback(async()=>{const m=window.prompt("Select image resolution","5000x5000");if(!m||!m.includes("x")){console.error("Invalid resolution");return}const[j,O]=m.split("x").map(F=>parseInt(F));if(isNaN(j)||isNaN(O)){console.error("Invalid resolution");return}const L=await(await tr(()=>import("./export-902100eb.js"),[],import.meta.url)).makeBigPng(e,j,O);if(L){const F=document.createElement("a");document.body.appendChild(F),F.style.display="none";const ge=window.URL.createObjectURL(L);F.href=ge,F.download=`${document.title}-${j}x${O}`,F.click()}},[e]);return s.jsxs(s.Fragment,{children:[s.jsx(mr,{open:c,onPreset:C,onExportImage:v,closePresets:d}),s.jsxs("div",{className:e.error?"error":"",title:e.error,children:[e.currentOrder<e.order?s.jsxs("aside",{className:"processing-counter",children:[e.currentOrder,"/",e.order]}):null,["simple","advanced","full"].includes(i)?s.jsx("button",{className:"preset-button button",onClick:()=>l(m=>!m),title:"Presets",children:"◭"}):null,["simple","advanced","full"].includes(i)?s.jsxs("aside",{className:"controls",children:[s.jsxs("button",{className:"controls-button button",onClick:H,title:"Rotation Mode",children:[s.jsx("span",{style:{display:"inline-block",transform:`rotate(${a.shift/a.maxShift*360}deg)`},children:"⥁"}),s.jsx("sup",{children:a.shift+1})]}),s.jsxs("div",{className:"subcontrols",children:[s.jsx("button",{className:"button anim-view",onClick:z,title:"Animate rotations",children:a.auto==="free"?"⤞":a.auto==="damp"?"↠":"?"}),!te(e.matrix)&&s.jsx("button",{className:"button reset-view",onClick:E,title:"Reset View",children:"⌖"})]})]}):null,s.jsx("button",{className:`space-button button${e.processing?" processing":""}${i==="empty"?" empty":""}`,onClick:b,children:s.jsx(y,{...e.spaceType||{},dimensions:e.dimensions})}),["advanced","full"].includes(i)&&s.jsxs("aside",{className:"parameters",children:[(i==="full"||r.grouper!=="")&&s.jsxs("label",{className:"select-label",children:["Grouper",s.jsx("select",{name:"grouper",value:r.grouper,onChange:p,children:Te.map(m=>s.jsx("option",{value:m,children:m===""?r.grouper===""?`Auto [${e.grouper.replace(/^auto-/,"")}]`:"Auto":m.replace(/_/g," ").replace(/\b./g,j=>j.toUpperCase())},m))})]}),(i==="full"||r.grouper)&&s.jsxs("label",{className:"boolean-label",children:["inCentered",s.jsx(re,{name:"centered",allowNull:!0,value:r.centered,onChange:u})]}),(i==="full"||e.curvature<=0)&&s.jsx(N,{name:"order",label:"Precision",min:1,step:1,value:r.order,onChange:u}),s.jsx(N,{name:"segments",label:"Segments",min:1,step:1,value:r.segments,toggler:r.curve,togglerName:"curve",onChange:u}),s.jsxs("label",{className:"select-label",children:["Easing",s.jsx("select",{name:"easing",value:r.easing,onChange:p,children:Ne.map(m=>s.jsx("option",{value:m,children:m.replace(/_/g," ").replace(/\b./g,j=>j.toUpperCase())},m))})]}),s.jsx(N,{name:"vertexThickness",label:"Vertices",min:0,step:1,value:r.vertexThickness,toggler:r.showVertices,togglerName:"showVertices",onChange:u}),s.jsx(N,{name:"edgeThickness",label:"Edges",min:0,step:1,value:r.edgeThickness,toggler:r.showEdges,togglerName:"showEdges",onChange:u}),(e.grouper.replace(/^auto-/,"")==="toddcoxeter"||e.grouper==="fundamental")&&s.jsxs("label",{className:"boolean-label",children:["Faces",s.jsx(re,{name:"showFaces",value:r.showFaces,onChange:u})]}),s.jsxs("label",{className:"select-label",children:["Ambiance",s.jsx("select",{name:"ambiance",value:r.ambiance,onChange:p,children:(i==="full"?Object.keys(Z):Object.entries(Z).filter(([m,{extended:j}])=>!j||m===r.ambiance).map(([m])=>m)).map(m=>s.jsx("option",{value:m,children:m.replace(/_/g," ").replace(/./,j=>j.toUpperCase())},m))})]})]}),["advanced","full"].includes(i)&&s.jsxs("aside",{className:"view",children:[s.jsx(N,{name:"msaaSamples",label:"MSAA",min:0,step:1,max:R.msaaSamples,value:r.msaaSamples,toggler:r.msaa,togglerName:"msaa",onChange:u}),i==="full"&&s.jsx(N,{name:"subsampling",label:"subsampling",min:.1,step:.1,value:r.subsampling,onChange:u}),r.dimensions>=3?Ae(3,r.dimensions+1).map(m=>s.jsxs("div",{className:"projection",children:[s.jsx(N,{label:`${m}D FOV`,name:`fov${m}`,step:1,value:r[`fov${m}`],onChange:u}),s.jsxs("label",{className:"number",children:[s.jsxs("span",{className:"number-label",children:[m,"D Projection"]}),s.jsx("select",{name:`projection${m}`,value:r[`projection${m}`],onChange:p,children:[...Le.filter((j,O)=>m===3||O<7)].map(j=>s.jsx("option",{value:j,children:j.replace(/_/g," ").replace(/./,O=>O.toUpperCase())},j))})]})]},m)):null]}),["simple","advanced","full"].includes(i)&&s.jsx(Ie,{dimensions:r.dimensions,coxeter:r.coxeter,mirrors:r.mirrors,stellation:r.stellation,extended:r.extended,onChange:u})]})]})}function xr({params:e,updateParams:r}){const[a,o]=h.useState({...e,currentOrder:0,askedOrder:null,spaceType:null,curvature:null,mirrorsPlanes:null,rootVertex:null,vertex:[],edge:[],ranges:[],face:[],processing:!0,error:null,renderError:null});h.useEffect(()=>{o(c=>{try{return c.gl?c:Pe(c)}catch(l){return console.error(l),{...c,error:l.message}}})},[a.gl]);const[n,i]=h.useState({shift:0,maxShift:0,combinations:[],auto:"damp"});h.useEffect(()=>{o(c=>({...c,...ce({order:e.order,ambiance:e.ambiance,showVertices:e.showVertices,showEdges:e.showEdges,showFaces:e.showFaces,vertexThickness:e.vertexThickness,edgeThickness:e.edgeThickness,projection3:e.projection3,projection4:e.projection4,projection5:e.projection5,projection6:e.projection6,projection7:e.projection7,projection8:e.projection8,projection9:e.projection9,msaa:e.msaa,msaaSamples:e.msaaSamples,subsampling:e.subsampling,matrix:e.matrix,fov3:e.fov3,fov4:e.fov4,fov5:e.fov5,fov6:e.fov6,fov7:e.fov7,fov8:e.fov8,fov9:e.fov9,zoom:e.zoom,curve:e.curve,segments:e.segments,easing:e.easing,dimensions:e.dimensions,coxeter:e.coxeter,mirrors:e.mirrors,stellation:e.stellation,centered:e.centered}).params}))},[e.order,e.ambiance,e.centered,e.coxeter,e.curve,e.dimensions,e.edgeThickness,e.fov3,e.fov4,e.fov5,e.fov6,e.fov7,e.fov8,e.fov9,e.matrix,e.mirrors,e.msaa,e.msaaSamples,e.projection3,e.projection4,e.projection5,e.projection6,e.projection7,e.projection8,e.projection9,e.segments,e.easing,e.showEdges,e.showFaces,e.showVertices,e.stellation,e.subsampling,e.vertexThickness,e.zoom]),h.useEffect(()=>{i(c=>({...c,shift:0,maxShift:~~Ve(He(e.dimensions,2)/2),combinations:De(ze(new Array(e.dimensions).fill().map((l,d)=>d),2)),auto:"damp"}))},[e.dimensions]),h.useEffect(()=>{o(c=>e.grouper===""&&c.grouper.startsWith("auto-")?c:{...c,grouper:e.grouper})},[e.grouper]);const t=h.useCallback((c,l)=>{i(d=>({...d,[c]:l}))},[i]);return a.gl?s.jsxs("div",{className:a.error||a.renderError?"error":"",title:a.error||a.renderError,children:[s.jsx(gr,{runtime:a,params:e,rotations:n,updateRotations:t,updateParams:r}),s.jsx(nr,{runtime:a,rotations:n,setRuntime:o,updateRotations:t,updateParams:r})]}):null}const se=(e=null)=>{const{location:r}=window;if(r.hash)try{return JSON.parse(atob(r.hash.slice(1)))}catch(a){console.warn(a),r.hash=""}return e},br=e=>{window.history.pushState(null,null,"#"+btoa(JSON.stringify(e)))},K=(e,r)=>e.length!==r.length?!1:e.every((a,o)=>Array.isArray(a)?K(a,r[o]):a===r[o]),jr=()=>{const[e,r]=h.useState(se(R)),a=h.useCallback(n=>{const i=se();i&&(Object.entries(i).forEach(([t,c])=>{Array.isArray(c)&&K(c,e[t])&&(i[t]=e[t])}),r(i))},[e]),o=h.useCallback(n=>{r(i=>{if(!Object.entries(n).filter(([l,d])=>Array.isArray(d)?!K(d,i[l]):i[l]!==d).length)return i;const{params:t,badParams:c}=ce({...i,...n},Object.keys(n));return c.length||br(t),t})},[]);return h.useEffect(()=>(window.addEventListener("popstate",a),()=>{window.removeEventListener("popstate",a)}),[a]),s.jsx(xr,{params:e,updateParams:o})};Be.createRoot(document.getElementById("root")).render(s.jsx(jr,{}));
